#include<iostream>
#include<map>
using namespace std;

int main()
{
	multimap<int, int> mp;
	mp.insert(make_pair(1000000000, 1));
	multimap<int, int>::iterator it;
	
	int n;
	cin >> n;
	for (int i = 0; i < n; i++)
	{
		multimap<int, int>::iterator left = mp.begin();
		multimap<int, int>::iterator right = mp.end();
		multimap<int, int>::iterator last = mp.end();
		last--;
		int a, b;
		cin >> a >> b;

		it = mp.lower_bound(b);

		if (it == left)
		{
			int t = it->first;
			int min = it->second;
			it++;
			while ( it != right && it->first == t)
			{
				if (min > it->second)
					min = it->second;
				it++;
			}
			cout << a << " " << min << endl;
		}
			
		else if (it == right)
		{
			//modify
			
			it--;
			int t = it->first;
			int min = it->second;
			it--;
			while (it != right && it->first == t)
			{
				if (min > it->second)
					min = it->second;
				it--;
			}
			cout << a << " " << min << endl;
		}
		else
		{
			//modify
			if (b == it->first)
			{
				int min = it->second;
				it++;
				while (it != right && it->first == b)
				{
					if (min > it->second)
						min = it->second;
					it++;
				}
				cout << a << " " << min << endl;
			}
				
			else
			{
				//modify,can it be faster if only one iterator be used?
				multimap<int, int>::iterator p = it;
				p--;
				int m1, m2, n1, n2;
				m1 = it->first;
				n1 = it->second;
				m2 = p->first;
				n2 = p->second;
				
				if (m1 - b == b - m2)
				{
					it++;
					while (it != right && it->first == m1)
					{
						if (n1 > p->second)
							n1 = p->second;
						it++;
					}
					p--;
					while (p != right && p->first == m1)
					{
						if (n1 > p->second)
							n1 = p->second;
						p++;
					}
					if (n1 > n2)
						file << a << " " << n2 << endl;
					else
						file << a << " " << n1 << endl;
				}
				else if (m1 - b < b - m2)
				{
					it++;
					while (it != right && it->first == m1)
					{
						if (n1 > p->second)
							n1 = p->second;
						it++;
					}
					file << a << " " << n1 << endl;
				}
				else
				{
					p--;
					while (p != right && p->first == m1)
					{
						if (n1 > p->second)
							n1 = p->second;
						p++;
					}
					file << a << " " << n2 << endl;
				}

			}
		}
		mp.insert(make_pair(b, a));
	}
}
